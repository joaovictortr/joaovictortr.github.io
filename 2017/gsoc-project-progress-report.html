<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="João Victor Risso's Blog, ">

        <link rel="alternate"  href="https://joaovictortr.me/feeds/all.atom.xml" type="application/atom+xml" title="João Victor Risso's Blog Full Atom Feed"/>

        <title>GSoC - The Road So Far // João Victor Risso's Blog // </title>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://joaovictortr.me/theme/css/pure.css">
    <link rel="stylesheet" href="https://joaovictortr.me/theme/css/pygments.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
    <div class="pure-g-r" id="layout">
        <div class="sidebar pure-u">
            <div class="cover-img" style="background: none repeat scroll 0% 0% #3D4F5D">
                <div class="cover-body">
                    <header class="header">
                        <hgroup>
                            <img class="avatar" src="https://joaovictortr.me/images/prof_bild.jpg">
                            <h1 class="brand-main"><a href="https://joaovictortr.me">João Victor Risso's Blog</a></h1>
                            <p class="tagline"></p>
                                <p class="social">
                                    <a href="https://github.com/joaovictortr">
                                        <i class="fa fa-github fa-3x"></i>
                                    </a>
                                    <a href="https://twitter.com/joaovictortr_">
                                        <i class="fa fa-twitter-square fa-3x"></i>
                                    </a>
                                    <a href="https://joaovictortr.me/feeds/all.atom.xml">
                                        <i class="fa fa-rss fa-3x"></i>
                                    </a>
                                </p>
                        </hgroup>
                    </header>
                </div>
            </div>
        </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>GSoC - The Road So&nbsp;Far</h1>
                        <p class="post-meta">
                            // under                                 <a class="post-category" href="https://joaovictortr.me/tag/python.html">python</a>
                                <a class="post-category" href="https://joaovictortr.me/tag/gsoc.html">gsoc</a>
                        </p>
                </header>
            </section>
            <p>In the last post, I have introduced what the GSoC project consisted of and the
operations I intend to implement by the end of the program. I am happy to announce
that the first part of the project is now completed, however it is still
pending to be merged. You can find the <span class="caps">PR</span> with the code and discussions on
the wrapper implementation <a href="https://github.com/Theano/Theano/pull/5949">here</a>.</p>
<h3>Connectionist Temporal&nbsp;Classification</h3>
<p>The first part of the project consisted in implementing a wrapper for Theano
that makes use of <a href="https://github.com/baidu-research/warp-ctc">warp-ctc</a>,
a fast implementation of the <span class="caps">CTC</span> loss function by Baidu Research. Their
implementation works both on multi-core processors (by using OpenMP threads)
and also on GPUs, using <span class="caps">CUDA</span> kernels to compute the <span class="caps">CTC</span> function. More details
on the inner workings of warp-ctc, can be found
<a href="https://github.com/baidu-research/warp-ctc">here</a> and <a href="http://arxiv.org/abs/1512.02595">here</a>.</p>
<p><span class="caps">CTC</span> stands for Connectionist Temporal Classification and it was proposed by
<a href="http://www.cs.toronto.edu/%7Egraves/icml_2006.pdf">Graves <em>et.al</em></a>. <span class="caps">CTC</span>
consists in a loss function that allows temporal classification of unsegmented
data in recurrent neural networks (RNNs). Problems with unsegmented data are
very common in perceptual tasks, such as handwriting recognition and speech&nbsp;recognition.</p>
<p>Labelling unsegmented sequence data, such as images and sound, was challenging
in RNNs because objective functions for these kinds of networks are defined
separately for each point (of features) in the training sequence. That meant
that training data had to be pre- and post-processed to obtain a final label&nbsp;sequence.</p>
<p>Outputs of a <span class="caps">CTC</span> network are given by a softmax layer, whose results are
interpreted as a probability distribution over all possible label sequences,
conditioned by a given input sequence. Given that distribution, an objective
function was derived to maximize the probabilities of correct labellings. Since
the objective function is differentiable, the network can be trained with
backpropagation through&nbsp;time.</p>
<p>At the moment, I am working on a functional example of the <span class="caps">CTC</span> functionality to
showcase how the implementation can be used in Theano. I&#8217;m building the network
using Lasagne, which is a lightweight library of neural network building
blocks on top of&nbsp;Theano.</p>
<h3>Spatial&nbsp;Transformer</h3>
<p>I have started working on the Spatial Transformer Op last week, with some of
the basic functionality already in place. The Op is built on top of cuDNN
functions that provide the components needed for a Spatial Transformer,
therefore the implementation will be limited to GPUs at the&nbsp;moment.</p>
<p>A Spatial Transformer is a component of a neural network that can provide
spatial manipulation of data within the network. Spatial manipulation can
improve models by introducing invariance to affine transformations, such as
translation, scaling and rotation. This kind of invariance improves classification
performance, since the networks become able to recognize, for example, distorted&nbsp;samples.</p>
<p><img alt="Spatial Transformer. Source: original paper by Jaderberg **et. al*" src="https://joaovictortr.me/images/spatial_transformer.png"></p>
<p>There are three main components in a Spatial Transformer, as shown in the image
above (provided in the <a href="https://arxiv.org/abs/1506.02025">paper by Jaderberg <em>et. al</em></a>):</p>
<ul>
<li>Localisation network: neural network that receives the input feature map U,
where U is a space spanned by the width, height and channels. It outputs the
parameters of the transformation to be applied to the feature map. In 2D, the
parameters take the form of a 2x3 matrix (i.e. an affine transformation matrix).
It can take the form of any neural network, but it should include a final regression
layer to produce the transformation&nbsp;parameters.</li>
<li>Grid generator: normalized grid of coordinates over the input feature map. It
maps the original coordinate system of the input to an interval in [-1, 1], and
applies the transformation the normalized&nbsp;space.</li>
<li>Sampler: sampler take a set of sampling points from the grid generator, along
with the input feature map U and produces the sampled output feature map&nbsp;V.</li>
</ul>
<p>The cuDNN library provides functions to create both the grid generator and the
sampler as well as the back-propagation functions. Therefore, the main task of
the second part is to provide a wrapper in Theano over these functions, in order
to provide the Spatial Transformer Op. There is a limitation however, cuDNN can
only handle 2D transformations on the inputs, so for now mainly images are&nbsp;supported.</p>
<p>Since it is still a work in progress, further testing is necessary for the grid
generator and the sampler. Back-propagation is not yet implemented, but it will
be soon. You can keep up with the development of the wrapper and provide feedback
in the <a href="https://github.com/Theano/Theano/pull/6061">pull request</a>.</p>
<h3>Showcasing and&nbsp;Examples</h3>
<p>I have started working today with Lasagne to implement neural network models to
demonstrate how to utilize the implementations, serving as a reference for users
interested in the&nbsp;functionalities.</p>
<p>So far, I am trying to find an interesting dataset to work with, specially on <span class="caps">CTC</span>,
mainly because the lack of open speech datasets. Also, the models proposed in the
original papers are somewhat complex, so they might take too much time to build,
so I will focus on building simpler&nbsp;models.</p>
<h3>Conclusion</h3>
<p>I have finished the first implementation part of the project, by providing the
wrapper warp-ctc. Now, I am working on implementing the Spatial Transformer,
with some of the basic functionalities already in place. Furthermore, I intend
to provide some simple models to demonstrate how to use the functionalities
using Lasagne and&nbsp;Theano.</p>
            <a href="#" class="go-top">Go Top</a>
    <div class="comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = "joaovictortrme"; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
<footer class="footer">
    <p>&copy; João Victor Risso &ndash;
        Built with <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
    </div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>

</body>
</html>